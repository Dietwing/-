# C4: Контекстная диаграмма — «НРИ-Помощник (офлайн)»

Ниже приведено пояснение **контекстной диаграммы (System Context)** для проекта **«НРИ-Помощник (офлайн)»**. Данная диаграмма показывает систему *как единое целое* и фиксирует: **кто** с ней взаимодействует, **зачем** и **каким способом** происходит обмен данными на самом верхнем уровне.

---

## 1) Назначение диаграммы

Контекстная диаграмма C4 отвечает на вопрос:  
**«Кто использует систему и в каком окружении она существует?»**

В связи с этим на схеме намеренно **нет внутренних модулей**, БД, слоев архитектуры и прочих деталей контейнерного уровня. Вместо этого акцент делается на:

- ролях пользователей (акторов);
- центральной системе (оффлайн-приложении);
- ключевых сценариях взаимодействия;
- внешнем канале передачи файла (как отдельной “среде” обмена).

---

## 2) Что изображено на диаграмме

### Центральная система

**«НРИ-Помощник (офлайн)»** представлен как система, ограниченная пунктирной рамкой (границей системы).  
Внутри границы находится основной системный элемент:

- **«Приложение НРИ»** — офлайн-инструмент, который предоставляет функционал:
  - расчёты и автоматизация механик (характеристики, проверки, броски и т. п.);
  - ведение боя (инициатива, события, состояния, лог столкновения);
  - журналирование событий сессии;
  - работа с правилами (справочник);
  - заметки и данные сессии;
  - импорт/экспорт листов персонажей (в файл).

Таким образом, граница системы отделяет то, что гарантированно контролируется приложением, от того, что находится вне его ответственности (например, мессенджеры).

---

## 3) Роли и их смысл в контексте проекта

### Ведущий (Мастер) — `GM`
Это основной пользователь во время игры. В рамках проекта ведущий:

- организует сессию и управляет ее ходом;
- настраивает правила/параметры (в пределах функционала приложения);
- ведёт боевые события и журнал;
- хранит заметки по кампании;
- **импортирует листы персонажей**, полученные от игроков.

Иными словами, ведущий — это пользователь, который работает не только с подготовкой, но и с управлением процессом сессии в реальном времени.

---

### Игрок — `P`
Игрок использует систему **в ограниченном режиме**, что согласуется с общей концепцией проекта, которую мы фиксировали ранее:

- игрок использует приложение **только для создания листа персонажа**;
- выполняет экспорт/выгрузку файла листа;
- передаёт файл ведущему для включения в “библиотеку” персонажей ведущего.

Вследствие этого игрок в контексте диаграммы выступает как источник данных о персонаже, но не как оператор управления сессией.

---

## 4) Внешний канал передачи файла (почему он вынесен отдельно)

На диаграмме отдельно выделен элемент:

**«Канал передачи файла (мессенджер/почта/флешка)»** — `CH`

Он не является частью системы «НРИ-Помощник», но важен как реальный и практичный путь обмена данными, поскольку проект **офлайн**:

- приложение не обязано иметь сервер;
- нет необходимости в постоянном сетевом взаимодействии;
- обмен листами персонажей происходит через файл.

Таким образом, `CH` показывает **внепрограммную инфраструктуру**, через которую пользовательские данные реально переходят от игрока к ведущему.

---

## 5) Взаимодействия (стрелки) и их интерпретация

### `GM → APP`
**«Управление сессией, настройка правил, ведение боя, заметки, импорт листов»**

Эта связь фиксирует основной сценарий использования ведущим:  
ведущий применяет приложение как главный инструмент управления игрой и данными сессии.

---

### `P → APP`
**«Создание листа персонажа (в приложении)»**

Игрок использует приложение локально, чтобы оформить персонажа и получить корректный набор характеристик, рассчитанных по правилам.

---

### `P → CH`
**«Экспорт/выгрузка файла листа»**

Данные персонажа выводятся из приложения в файл (например, JSON или иной формат, принятый в проекте). На контекстном уровне достаточно зафиксировать сам факт выгрузки.

---

### `CH → GM`
**«Передача файла листа для импорта в библиотеку»**

Ведущий получает файл любым удобным способом и далее уже импортирует его в приложение, что замыкает цепочку обмена данными.

---

## 6) Главный смысл диаграммы (вывод)

Контекстная диаграмма показывает, что система «НРИ-Помощник (офлайн)»:

- является **локальным приложением** без обязательного серверного контура;
- обслуживает **две роли** с различными уровнями доступа и задач:
  - игрок — создание и экспорт листа персонажа;
  - ведущий — управление сессией, боем и данными кампании;
- предполагает передачу листов персонажей **через внешний файловый канал**, который не относится к границам системы, но является необходимым элементом реального сценария использования.

Именно поэтому данная диаграмма является стартовой точкой C4-описания: она задаёт границы ответственности и подготавливает переход к **Container-уровню**, где мы уже будем раскрывать внутреннюю структуру приложения (хранилище, подсистемы, основные блоки функционала).
